<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta content="width=device-width,initial-scale=1" name="viewport">
  <title>FilmFrei: Serien genie√üen ‚Äì ganz ohne Werbung</title>
  <style>
  * {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif
}

body {
  background-color: #121212;
  color: #f5f5f5;
  overflow-x: hidden;
  padding-top: 70px
}

.nav-buttons {
  display: flex;
  justify-content: center;
  gap: 20px;
  padding: 15px 0;
  margin-bottom: 20px;
}

.nav-button {
  background-color: #0a84ff;
  color: white;
  border: none;
  border-radius: 20px;
  padding: 10px 25px;
  font-size: 16px;
  font-weight: 500;
  text-decoration: none;
  transition: all 0.3s ease;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
}

.nav-button:hover {
  background-color: #0071e3;
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
}

header {
  position: sticky;
  top: 0;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 20px 40px;
  background-color: rgba(18, 18, 18, .95);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: 100;
  border-bottom: 1px solid rgba(255, 255, 255, .05)
}

.logo-container {
  display: flex;
  align-items: center;
  gap: 15px
}

.brand-name {
  font-size: 24px;
  font-weight: 600;
  letter-spacing: -.5px
}

.search-container {
  position: relative;
  max-width: 300px;
  width: 100%
}

.search-input {
  width: 100%;
  padding: 10px 40px 10px 15px;
  border-radius: 20px;
  border: none;
  background-color: #1e1e1e;
  color: #f5f5f5;
  font-size: 16px;
  transition: all .3s ease
}

.search-input:focus {
  outline: 0;
  background-color: #2a2a2a;
  box-shadow: 0 0 0 2px rgba(10, 132, 255, .5)
}

.search-icon {
  position: absolute;
  right: 15px;
  top: 50%;
  transform: translateY(-50%);
  color: #999;
  pointer-events: none
}

.search-results {
  position: absolute;
  top: 50px;
  width: 100%;
  background-color: #1a1a1a;
  border-radius: 12px;
  max-height: 0;
  overflow: hidden;
  transition: max-height .3s ease;
  box-shadow: 0 5px 20px rgba(0, 0, 0, .3);
  z-index: 200
}

.search-results.active {
  max-height: 300px;
  overflow-y: auto
}

.search-result-item {
  padding: 12px 15px;
  cursor: pointer;
  border-bottom: 1px solid rgba(255, 255, 255, .05)
}

.search-result-item:hover {
  background-color: #2a2a2a
}

main {
  padding: 40px
}

.section-title {
  font-size: 22px;
  font-weight: 600;
  margin-bottom: 20px;
  color: #f5f5f5
}

.film-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: 25px;
  margin-bottom: 40px
}

/* Angepasste Film-Card f√ºr feste Bildgr√∂√üen */
.film-card {
  position: relative;
  border-radius: 12px;
  overflow: hidden;
  transition: transform .3s ease, box-shadow .3s ease;
  cursor: pointer;
  background-color: #1a1a1a;
  width: 100%;
  /* Feste H√∂he f√ºr die Karten */
  height: 270px;
}

.film-card:hover {
  transform: scale(1.03) translateY(-5px);
  box-shadow: 0 10px 25px rgba(0, 0, 0, .4)
}

.film-card img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: opacity .3s ease;
  /* Verhindern, dass Bilder die Gr√∂√üe ver√§ndern */
  object-position: center top;
  max-height: 270px;
}

.film-info {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  padding: 60px 15px 15px;
  background: linear-gradient(to top, rgba(0, 0, 0, .8), transparent);
  opacity: 0;
  transition: opacity .3s ease
}

.film-card:hover .film-info {
  opacity: 1
}

.film-title {
  font-size: 16px;
  font-weight: 500;
  margin-bottom: 4px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis
}

.film-year {
  font-size: 14px;
  color: #bbb
}

.film-detail-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, .85);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: 1000;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  visibility: hidden;
  transition: opacity .3s ease, visibility .3s ease
}

.film-detail-overlay.active {
  opacity: 1;
  visibility: visible
}

.film-detail-container {
  display: flex;
  max-width: 1200px;
  width: 90%;
  background-color: #1a1a1a;
  border-radius: 15px;
  overflow: hidden;
  box-shadow: 0 20px 40px rgba(0, 0, 0, .5);
  transform: translateY(30px);
  opacity: 0;
  transition: transform .4s ease, opacity .4s ease
}

.film-detail-overlay.active .film-detail-container {
  transform: translateY(0);
  opacity: 1
}

.film-detail-left {
  flex: 1;
  padding: 30px
}

/* Feste Gr√∂√üe f√ºr das Detail-Cover-Bild */
.film-detail-cover {
  width: 100%;
  height: 300px;
  object-fit: cover;
  border-radius: 10px;
  box-shadow: 0 5px 15px rgba(0, 0, 0, .3);
  object-position: center top;
}

.film-detail-info {
  margin-top: 20px
}

.film-detail-title {
  font-size: 24px;
  font-weight: 600;
  margin-bottom: 10px
}

.film-detail-meta {
  display: flex;
  margin-bottom: 15px;
  color: #bbb;
  font-size: 14px
}

.film-detail-description {
  line-height: 1.6;
  color: #ddd
}

.film-detail-right {
  flex: 2;
  position: relative
}

.film-detail-player {
  width: 100%;
  height: 100%;
  background-color: #000
}

.film-player-iframe {
  width: 100%;
  height: 100%;
  border: none
}

.film-detail-close {
  position: absolute;
  top: 20px;
  right: 20px;
  width: 36px;
  height: 36px;
  border-radius: 50%;
  background-color: rgba(0, 0, 0, .5);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  z-index: 1010;
  transition: background-color .3s ease
}

.film-detail-close:hover {
  background-color: rgba(255, 255, 255, .2)
}

.film-detail-close:after,
.film-detail-close:before {
  content: '';
  position: absolute;
  width: 18px;
  height: 2px;
  background-color: #fff
}

.film-detail-close:before {
  transform: rotate(45deg)
}

.film-detail-close:after {
  transform: rotate(-45deg)
}

/* Serienspezifische Styles */
.season-select,
.episode-select {
  background-color: #2a2a2a;
  color: #f5f5f5;
  border: none;
  border-radius: 5px;
  padding: 8px 12px;
  font-size: 14px;
  margin-right: 10px;
  cursor: pointer;
  transition: background-color .3s ease;
  outline: none;
}

.season-select:hover,
.episode-select:hover {
  background-color: #3a3a3a;
}

.season-select:focus,
.episode-select:focus {
  box-shadow: 0 0 0 2px rgba(10, 132, 255, .5);
}

.cookie-banner {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  width: 90%;
  max-width: 400px;
  background-color: #1e1e1e;
  border-radius: 12px;
  padding: 20px;
  box-shadow: 0 5px 20px rgba(0, 0, 0, .4);
  z-index: 900;
  display: none
}

.cookie-title {
  font-size: 18px;
  font-weight: 600;
  margin-bottom: 10px
}

.cookie-text {
  font-size: 14px;
  line-height: 1.5;
  margin-bottom: 15px;
  color: #ddd
}

.cookie-actions {
  display: flex;
  justify-content: space-between
}

.cookie-accept {
  padding: 10px 20px;
  border-radius: 20px;
  border: none;
  background-color: #0a84ff;
  color: #fff;
  font-weight: 500;
  cursor: pointer;
  transition: background-color .3s ease
}

.cookie-accept:hover {
  background-color: #0071e3
}

.cookie-more {
  color: #999;
  text-decoration: none;
  font-size: 14px;
  align-self: center
}

.cookie-more:hover {
  text-decoration: underline
}

.alert {
  margin: 20px auto;
  max-width: 700px;
  background-color: #3a1a1a;
  color: #fff1f1;
  padding: 15px 20px;
  border-radius: 10px;
  font-size: 14px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, .3);
  position: relative;
  text-align: center
}

.closebtn {
  position: absolute;
  right: 15px;
  top: 12px;
  font-size: 20px;
  cursor: pointer;
  color: #fff;
  font-weight: 700
}

.loader {
  border: 8px solid #333;
  border-top: 8px solid #fff;
  border-radius: 50%;
  width: 60px;
  height: 60px;
  animation: spin 1s linear infinite;
  margin: 30px auto;
  display: none
}

@keyframes spin {
  0% {
    transform: rotate(0)
  }

  100% {
    transform: rotate(360deg)
  }
}

#popupNotice {
  margin-top: 20px;
  color: orange;
  font-size: 14px;
  display: none;
  text-align: center
}

footer {
  text-align: center;
  padding: 20px;
  color: #999;
  font-size: 14px;
  margin-top: 40px;
}

@media (max-width:1024px) {
  .film-detail-container {
    flex-direction: column;
    max-height: 90vh;
    overflow-y: auto
  }

  .film-detail-left {
    display: flex;
    flex-direction: row;
    padding: 20px
  }

  .film-detail-cover {
    width: 40%;
    max-width: 200px;
    height: auto;
  }

  .film-detail-info {
    margin-top: 0;
    margin-left: 20px;
    flex: 1
  }

  .film-detail-right {
    height: 400px
  }
}

@media (max-width:768px) {
  header {
    padding: 15px 20px
  }

  main {
    padding: 20px
  }

  .film-grid {
    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
    gap: 15px
  }

  .film-card {
    height: 210px;
  }

  .film-card img {
    max-height: 210px;
  }

  .film-detail-left {
    flex-direction: column
  }

  .film-detail-cover {
    width: 100%;
    max-width: none;
    height: 250px;
  }

  .film-detail-info {
    margin-left: 0;
    margin-top: 20px
  }

  .film-detail-right {
    height: 300px
  }
}

@media (max-width:480px) {
  .search-container {
    width: 100%;
    margin-top: 10px;
    padding: 0 10px;
  }

  .nav-buttons {
    flex-wrap: wrap;
  }

  .film-card {
    height: 180px;
  }

  .film-card img {
    max-height: 180px;
  }

  .film-detail-overlay {
    align-items: flex-end
  }

  .film-detail-container {
    width: 100%;
    height: 90%;
    border-radius: 15px 15px 0 0
  }

  .film-detail-cover {
    height: 200px;
  }
}

/* Fallback f√ºr Bilder, die nicht geladen werden k√∂nnen */
.image-placeholder {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: #2a2a2a;
  color: #777;
  font-size: 14px;
  text-align: center;
  padding: 10px;
}

/* Animation f√ºr Bilder */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.film-card img {
  animation: fadeIn 0.3s ease-out forwards;
}
  </style>
</head>
<body>
  <!-- Navigation Buttons -->
  <div class="nav-buttons">
    <a href="https://filmfrei.github.io/FilmFrei" class="nav-button">zu Filme</a>
  </div>
  
  <!-- DNS-Warnung/Meldung -->
  <div class="alert">
    <span class="closebtn" onclick="this.parentElement.style.display='none';">√ó</span>
    <center>
      <strong>Liebe FilmFrei-User,</strong><br>
      Einige Anbieter blockieren uns. Wenn Sie betroffen sind, lesen Sie unseren 
      <a href="https://filmfrei.github.io/FilmFrei-DNS" style="color: #3498db; text-decoration: underline; font-weight: bold;">Artikel</a> 
      zur L√∂sung des Problems.<br>
      <strong>Danke f√ºr euer Vertrauen ‚Äì euer FilmFrei-Team</strong>
    </center>
  </div>
  
  <header>
    <!-- Markennamen -->
    <div class="logo-container">
      <div class="brand-name">FilmFrei</div>
    </div>
    
    <!-- Suchleiste -->
    <div class="search-container">
      <input class="search-input" id="search" placeholder="Serie suchen...">
      <div class="search-icon">
        <svg fill="none" height="16" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
          <circle cx="11" cy="11" r="8"></circle>
          <line x1="21" x2="16.65" y1="21" y2="16.65"></line>
        </svg>
      </div>
      <div class="search-results" id="search-results"></div>
    </div>
  </header>
  
  <main>
    <section>
      <h2 class="section-title">Neueste Serien</h2>
      <div class="film-grid" id="latest-series"></div>
    </section>
    <section>
      <h2 class="section-title">Alle Serien</h2>
      <div class="film-grid" id="series-list"></div>
    </section>
  </main>
  
  <!-- Detail-Overlay f√ºr Serien -->
  <div class="film-detail-overlay">
    <div class="film-detail-close"></div>
    <div class="film-detail-container">
      <div class="film-detail-left">
        <img alt="" class="film-detail-cover" src="">
        <div class="film-detail-info">
          <h3 class="film-detail-title"></h3>
          <div class="film-detail-meta">
            <select id="season-select" class="season-select"></select>
            <select id="episode-select" class="episode-select"></select>
          </div>
          <p class="film-detail-description"></p>
        </div>
      </div>
      <div class="film-detail-right">
        <div class="loader" id="loader"></div>
        <div id="popupNotice">üö´ Popup-Versuch wurde blockiert!</div>
        <div class="film-detail-player"></div>
      </div>
    </div>
  </div>
  
  <!-- Cookie-Banner -->
  <div class="cookie-banner">
    <div class="cookie-title">Cookies gef√§llig?</div>
    <div class="cookie-text">Diese Seite verwendet Cookies, um dein Erlebnis zu verbessern.</div>
    <div class="cookie-actions">
      <button class="cookie-accept">Verstanden</button> 
      <a class="cookie-more" href="https://filmfrei.github.io/FilmFrei-Datenschutz/">Mehr erfahren</a>
    </div>
  </div>

  <footer>¬© 2025 Filmfrei ‚Äì Alle Rechte vorbehalten</footer>

  <script>
// DOM-Elemente initialisieren
document.addEventListener('DOMContentLoaded', function() {
  const latestSeriesContainer = document.getElementById('latest-series');
  const seriesListContainer = document.getElementById('series-list');
  const searchInput = document.querySelector('.search-input');
  const searchResults = document.querySelector('.search-results');
  const filmDetailOverlay = document.querySelector('.film-detail-overlay');
  const filmDetailClose = document.querySelector('.film-detail-close');
  const cookieBanner = document.querySelector('.cookie-banner');
  const cookieAccept = document.querySelector('.cookie-accept');

  // Serien-Daten direkt im Code (ersetzen Sie dies durch Ihre eigenen Serien)
  const seriesData = [
    // Hier eigene Serien einf√ºgen
    // Beispielformat:
    /*
    {
      "title": "Serientitel",
      "description": "Beschreibung der Serie",
      "cover": "https://example.com/cover.jpg",
      "seasons": [
        {
          "season": "1",
          "episodes": [
            {
              "episode": "1",
              "title": "Episodentitel",
              "voe_redirect": "https://example.com/redirect/url"
            },
            // Weitere Episoden...
          ]
        },
        // Weitere Staffeln...
      ]
    },
    */
  ];

  // Sortiere nach neuesten Serien (falls vorhanden)
  const sortedByDate = [...seriesData].sort((a, b) => {
    // Falls hochgeladenAm existiert, danach sortieren
    if (a.hochgeladenAm && b.hochgeladenAm) {
      return new Date(b.hochgeladenAm) - new Date(a.hochgeladenAm);
    }
    // Ansonsten alphabetisch nach Titel
    return a.title.localeCompare(b.title);
  });

  // Neueste Serien anzeigen (die ersten 4)
  sortedByDate.slice(0, 4).forEach(series => {
    latestSeriesContainer.appendChild(createSeriesCard(series));
  });

  // Alle Serien anzeigen
  sortedByDate.forEach(series => {
    seriesListContainer.appendChild(createSeriesCard(series));
  });

  // Eine Serien-Karte erstellen
  function createSeriesCard(series) {
    const card = document.createElement('div');
    card.classList.add('film-card');
    
    // Fallback f√ºr Cover-URL
    const coverUrl = series.cover || '';
    
    card.innerHTML = `
      <img src="${coverUrl}" alt="${series.title}" onerror="handleImageError(this, '${series.title}')">
      <div class="film-info">
        <div class="film-title">${series.title}</div>
        <div class="film-year">Serie</div>
      </div>
    `;
    
    card.addEventListener('click', () => showSeriesDetail(series));
    return card;
  }

  // Bildladefehler-Handler
  window.handleImageError = function(img, title) {
    const seriesTitle = title || img.alt || 'Serie';
    const encodedTitle = seriesTitle.replace(/"/g, '&quot;');
    img.src = `data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 300" width="100%" height="100%"><rect width="100%" height="100%" fill="%232a2a2a"/><text x="50%" y="50%" font-family="Arial" font-size="16" fill="%23777" text-anchor="middle">${encodedTitle}</text></svg>`;
  };

  // Suchfunktion
  if (searchInput) {
    searchInput.addEventListener('input', (e) => {
      const searchTerm = e.target.value.toLowerCase();
      if (searchTerm.length < 2) {
        searchResults.classList.remove('active');
        return;
      }

      const matchedSeries = seriesData.filter(series =>
        series.title.toLowerCase().includes(searchTerm) ||
        (series.description && series.description.toLowerCase().includes(searchTerm))
      );

      searchResults.innerHTML = '';

      if (matchedSeries.length > 0) {
        matchedSeries.forEach(series => {
          const resultItem = document.createElement('div');
          resultItem.classList.add('search-result-item');
          resultItem.textContent = series.title;
          resultItem.addEventListener('click', () => {
            showSeriesDetail(series);
            searchResults.classList.remove('active');
            searchInput.value = '';
          });
          searchResults.appendChild(resultItem);
        });
        searchResults.classList.add('active');
      } else {
        searchResults.classList.remove('active');
      }
    });

    // Klick au√üerhalb der Suche schlie√üt die Suchergebnisse
    document.addEventListener('click', (e) => {
      if (!e.target.closest('.search-container')) {
        searchResults.classList.remove('active');
      }
    });
  }

  // Serien-Details anzeigen
  function showSeriesDetail(series) {
    const coverImg = filmDetailOverlay.querySelector('.film-detail-cover');
    const title = filmDetailOverlay.querySelector('.film-detail-title');
    const description = filmDetailOverlay.querySelector('.film-detail-description');
    const seasonSelect = document.getElementById('season-select');
    const episodeSelect = document.getElementById('episode-select');
    const player = filmDetailOverlay.querySelector('.film-detail-player');
    const loader = document.getElementById('loader');
    const popupNotice = document.getElementById('popupNotice');

    // Daten setzen
    coverImg.src = series.cover || '';
    coverImg.alt = series.title;
    coverImg.onerror = function() {
      handleImageError(this, series.title);
    };
    
    title.textContent = series.title;
    description.textContent = series.description || 'Keine Beschreibung verf√ºgbar';

    // Staffel-Auswahl leeren und neu bef√ºllen
    seasonSelect.innerHTML = '';
    
    // Nur g√ºltige Staffeln filtern
    const validSeasons = series.seasons ? series.seasons.filter(season => {
      const seasonName = (season.season || '').toLowerCase().trim();
      return seasonName && seasonName !== 'filme' && seasonName !== 'film' && 
             Array.isArray(season.episodes) && season.episodes.length > 0;
    }) : [];

    // Wenn keine Staffeln verf√ºgbar sind, Meldung anzeigen
    if (validSeasons.length === 0) {
      seasonSelect.innerHTML = '<option disabled selected>Keine Staffeln verf√ºgbar</option>';
      episodeSelect.innerHTML = '<option disabled selected>Keine Episoden verf√ºgbar</option>';
      
      player.innerHTML = `
        <div style="display: flex; align-items: center; justify-content: center; height: 100%; background-color: #1a1a1a; color: #ccc; text-align: center; padding: 20px;">
          <div>
            <div style="font-size: 36px; margin-bottom: 20px;">üì∫</div>
            <div style="font-size: 18px;">Diese Serie hat noch keine Staffeln oder Episoden.</div>
          </div>
        </div>
      `;
      
      // Overlay trotzdem anzeigen
      filmDetailOverlay.classList.add('active');
      document.body.style.overflow = 'hidden';
      return;
    }

    // Staffeln zur Auswahl hinzuf√ºgen
    validSeasons.forEach((season, i) => {
      const opt = document.createElement('option');
      opt.value = i;
      opt.textContent = `Staffel ${season.season}`;
      seasonSelect.appendChild(opt);
    });

    // Event-Listener f√ºr Staffel-√Ñnderung
    seasonSelect.onchange = () => {
      updateEpisodes(validSeasons);
      // Erste Episode der neuen Staffel ausw√§hlen
      episodeSelect.selectedIndex = 0;
      loadEpisode(validSeasons);
    };

    // Event-Listener f√ºr Episoden-√Ñnderung
    episodeSelect.onchange = () => loadEpisode(validSeasons);

    // Standardm√§√üig erste Staffel ausw√§hlen
    seasonSelect.selectedIndex = 0;
    updateEpisodes(validSeasons);
    episodeSelect.selectedIndex = 0;
    
    // Serie laden und Overlay anzeigen
    filmDetailOverlay.classList.add('active');
    document.body.style.overflow = 'hidden';
    
    // Episode laden
    loadEpisode(validSeasons);
  }
  
  // Episoden der ausgew√§hlten Staffel anzeigen
  function updateEpisodes(seasons) {
    const seasonSelect = document.getElementById('season-select');
    const episodeSelect = document.getElementById('episode-select');
    const season = seasons[seasonSelect.value];
    
    episodeSelect.innerHTML = '';
    season.episodes.forEach((ep, i) => {
      const opt = document.createElement('option');
      opt.value = i;
      opt.textContent = `${ep.episode}. ${ep.title}`;
      episodeSelect.appendChild(opt);
    });
  }
  
  // Episode laden
  function loadEpisode(seasons) {
    const seasonSelect = document.getElementById('season-select');
    const episodeSelect = document.getElementById('episode-select');
    const player = filmDetailOverlay.querySelector('.film-detail-player');
    const loader = document.getElementById('loader');
    const popupNotice = document.getElementById('popupNotice');

    const season = seasons[seasonSelect.value];
    const episode = season.episodes[episodeSelect.value];

    // Pr√ºfen, ob die Episode einen g√ºltigen Link hat
    if (episode && episode.voe_redirect) {
      loader.style.display = 'block';
      popupNotice.style.display = 'none';
      player.innerHTML = '';
      
      // Verz√∂gerung einbauen, um Lader anzuzeigen
      setTimeout(() => {
        player.innerHTML = `
          <iframe id="videoFrame" src="${episode.voe_redirect}" 
              title="Serienspieler f√ºr ${season.season}, Episode ${episode.episode}"
              sandbox="allow-scripts allow-same-origin allow-presentation" 
              allowfullscreen 
              style="width: 100%; height: 100%; border: none; border-radius: 12px;">
          </iframe>
        `;

        const iframe = document.getElementById('videoFrame');
        
        // Popup-Blocker-Funktion
        iframe.onload = () => {
          loader.style.display = 'none';
          try {
            iframe.contentWindow.open = function() {
              popupNotice.style.display = 'block';
              console.warn('Popup-Versuch wurde blockiert!');
              return null;
            };
          } catch (e) {
            console.warn('Cross-Origin-Schutz: window.open konnte nicht √ºberschrieben werden.');
          }
        };
      }, 500);
    } else {
      player.innerHTML = '<div style="padding: 20px; text-align: center;">F√ºr diese Episode ist noch kein Stream verf√ºgbar.</div>';
      loader.style.display = 'none';
    }
  }

  // Overlay schlie√üen
  if (filmDetailClose) {
    filmDetailClose.addEventListener('click', closeSeriesDetail);
    filmDetailOverlay.addEventListener('click', (e) => {
      if (e.target === filmDetailOverlay) {
        closeSeriesDetail();
      }
    });
  }

  function closeSeriesDetail() {
    filmDetailOverlay.classList.remove('active');
    document.body.style.overflow = '';
    const player = filmDetailOverlay.querySelector('.film-detail-player');
    player.innerHTML = '';
    document.getElementById('popupNotice').style.display = 'none';
  }

  // Touch-Events f√ºr mobiles Schlie√üen
  let touchStartY = 0;
  let touchEndY = 0;

  filmDetailOverlay.addEventListener('touchstart', (e) => {
    touchStartY = e.changedTouches[0].screenY;
  }, false);

  filmDetailOverlay.addEventListener('touchend', (e) => {
    touchEndY = e.changedTouches[0].screenY;
    handleSwipe();
  }, false);

  function handleSwipe() {
    const swipeDistance = touchEndY - touchStartY;
    if (swipeDistance > 100) {
      closeSeriesDetail();
    }
  }

  // Cookie-Banner
  if (cookieBanner && cookieAccept) {
    if (!localStorage.getItem('cookiesAccepted')) {
      cookieBanner.style.display = 'block';
    }

    cookieAccept.addEventListener('click', () => {
      localStorage.setItem('cookiesAccepted', 'true');
      cookieBanner.style.display = 'none';
    });
  }

  // Hintergrund-Animation mit Farbverlauf
  const mainElement = document.querySelector('main');
  let gradientPosition = 0;

  function animateGradient() {
    gradientPosition = (gradientPosition + 0.2) % 360;
    const gradient = 
      `radial-gradient(circle at ${50 + Math.sin(gradientPosition * Math.PI / 180) * 10}% ${50 + Math.cos(gradientPosition * Math.PI / 180) * 10}%, rgba(10, 132, 255, 0.03), transparent 60%)`;
    mainElement.style.backgroundImage = gradient;
    requestAnimationFrame(animateGradient);
  }

  // Animation starten
  animateGradient();
});
  </script>
</body>
</html>